<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Exports | MetaMask Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/metamask-fox.svg">
    <link rel="manifest" href="/manifest.json">
    <script data-domain="docs.metamask.io" src="https://plausible.io/js/plausible.js"></script>
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="Developer documentation for the MetaMask Ethereum wallet">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.12c93c8c.css" as="style"><link rel="preload" href="/assets/js/app.b99f72c6.js" as="script"><link rel="preload" href="/assets/js/4.da077af0.js" as="script"><link rel="preload" href="/assets/js/37.c343127d.js" as="script"><link rel="preload" href="/assets/js/8.5b856ab8.js" as="script"><link rel="prefetch" href="/assets/js/10.931ea624.js"><link rel="prefetch" href="/assets/js/11.f4837159.js"><link rel="prefetch" href="/assets/js/12.4a379e87.js"><link rel="prefetch" href="/assets/js/13.054ad545.js"><link rel="prefetch" href="/assets/js/14.60991efe.js"><link rel="prefetch" href="/assets/js/15.bb808957.js"><link rel="prefetch" href="/assets/js/16.156d4b17.js"><link rel="prefetch" href="/assets/js/17.d480dbab.js"><link rel="prefetch" href="/assets/js/18.e857a728.js"><link rel="prefetch" href="/assets/js/19.4744b75b.js"><link rel="prefetch" href="/assets/js/20.3b820be5.js"><link rel="prefetch" href="/assets/js/21.7f788a6b.js"><link rel="prefetch" href="/assets/js/22.1a851cae.js"><link rel="prefetch" href="/assets/js/23.183a4108.js"><link rel="prefetch" href="/assets/js/24.3b89b233.js"><link rel="prefetch" href="/assets/js/25.aaf6d8d8.js"><link rel="prefetch" href="/assets/js/26.851366da.js"><link rel="prefetch" href="/assets/js/27.bd99d4d7.js"><link rel="prefetch" href="/assets/js/28.372a6ee4.js"><link rel="prefetch" href="/assets/js/29.c4bbbb87.js"><link rel="prefetch" href="/assets/js/30.b54b88d7.js"><link rel="prefetch" href="/assets/js/31.a4ba52f1.js"><link rel="prefetch" href="/assets/js/32.06188479.js"><link rel="prefetch" href="/assets/js/33.2e39f5e8.js"><link rel="prefetch" href="/assets/js/34.b074a91f.js"><link rel="prefetch" href="/assets/js/35.1373bc31.js"><link rel="prefetch" href="/assets/js/36.7e175d0c.js"><link rel="prefetch" href="/assets/js/38.bc59aa30.js"><link rel="prefetch" href="/assets/js/39.2eeec95f.js"><link rel="prefetch" href="/assets/js/40.09cfdbdc.js"><link rel="prefetch" href="/assets/js/41.84dfac92.js"><link rel="prefetch" href="/assets/js/5.25a3c5c3.js"><link rel="prefetch" href="/assets/js/6.83c305ad.js"><link rel="prefetch" href="/assets/js/7.1de43fb3.js"><link rel="prefetch" href="/assets/js/9.1df3fa70.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.d5583204.js"><link rel="prefetch" href="/assets/js/vendors~notification.7830c261.js">
    <link rel="stylesheet" href="/assets/css/0.styles.12c93c8c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/metamask-fox.svg" alt="MetaMask Docs" class="logo"> <span class="site-name can-hide">MetaMask Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div> <a href="https://github.com/MetaMask/metamask-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div> <a href="https://github.com/MetaMask/metamask-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/guide/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/guide/common-terms.html" class="sidebar-link">Common Terms</a></li><li><a href="/guide/initializing-dapps.html" class="sidebar-link">Initializing Dapps</a></li><li><a href="/guide/accessing-accounts.html" class="sidebar-link">Accessing Accounts</a></li><li><a href="/guide/sending-transactions.html" class="sidebar-link">Sending Transactions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API Reference</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/ethereum-provider.html" class="sidebar-link">Ethereum Provider API</a></li><li><a href="/guide/provider-migration.html" class="sidebar-link">Provider Migration Guide</a></li><li><a href="/guide/rpc-api.html" class="sidebar-link">RPC API</a></li><li><a href="/guide/signing-data.html" class="sidebar-link">Signing Data</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Best Practices</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/registering-function-names.html" class="sidebar-link">Registering Your Contract's Method Names</a></li><li><a href="/guide/registering-your-token.html" class="sidebar-link">Registering Tokens with Users</a></li><li><a href="/guide/defining-your-icon.html" class="sidebar-link">Defining Your App's Icon</a></li><li><a href="/guide/onboarding-library.html" class="sidebar-link">Onboarding Library</a></li><li><a href="/guide/metamask-extension-provider.html" class="sidebar-link">MetaMask Extension Provider</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Mobile</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/mobile-getting-started.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/site-compatibility-checklist.html" class="sidebar-link">Site Compatibility Checklist</a></li><li><a href="/guide/mobile-best-practices.html" class="sidebar-link">Best Practices</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Snaps</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/snaps.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/snaps-development-guide.html" class="sidebar-link">Development Guide</a></li><li><a href="/guide/snaps-rpc-api.html" class="sidebar-link">JSON-RPC API</a></li><li><a href="/guide/snaps-permissions.html" class="sidebar-link">Permissions</a></li><li><a href="/guide/snaps-exports.html" aria-current="page" class="active sidebar-link">Exports</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/snaps-exports.html#table-of-contents" class="sidebar-link">Table of Contents</a></li><li class="sidebar-sub-header"><a href="/guide/snaps-exports.html#onrpcrequest" class="sidebar-link">onRpcRequest</a></li><li class="sidebar-sub-header"><a href="/guide/snaps-exports.html#ontransaction" class="sidebar-link">onTransaction</a></li><li class="sidebar-sub-header"><a href="/guide/snaps-exports.html#oncronjob" class="sidebar-link">onCronjob</a></li></ul></li><li><a href="/guide/snaps-patching-dependencies.html" class="sidebar-link">Patching Dependencies</a></li><li><a href="/guide/snaps-concepts.html" class="sidebar-link">Concepts</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Resources</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/create-dapp.html" class="sidebar-link">Create A Simple Dapp</a></li><li><a href="/guide/contributors.html" class="sidebar-link">Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="exports"><a href="#exports" class="header-anchor">#</a> Exports</h1> <div class="custom-block tip"><p class="custom-block-title">Developer Preview Software</p> <p>Snaps is pre-release software. To try Snaps, install <a href="https://metamask.io/flask" target="_blank" rel="noopener noreferrer">MetaMask Flask<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <div class="custom-block tip"><p class="custom-block-title">Feature Requests</p> <p>Do you have feature requests? Other ideas? We'd love to hear about them! <a href="https://github.com/MetaMask/snaps-monorepo/discussions" target="_blank" rel="noopener noreferrer">Click here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to join the discussion.</p></div> <h2 id="table-of-contents"><a href="#table-of-contents" class="header-anchor">#</a> Table of Contents</h2> <p></p><div class="table-of-contents"><ul><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#onrpcrequest">onRpcRequest</a><ul><li><a href="#parameters">Parameters</a></li><li><a href="#returns">Returns</a></li><li><a href="#examples">Examples</a></li></ul></li><li><a href="#ontransaction">onTransaction</a><ul><li><a href="#parameters">Parameters</a></li><li><a href="#returns">Returns</a></li><li><a href="#examples">Examples</a></li></ul></li><li><a href="#oncronjob">onCronjob</a><ul><li><a href="#parameters">Parameters</a></li><li><a href="#examples">Examples</a></li></ul></li></ul></div><p></p> <h2 id="onrpcrequest"><a href="#onrpcrequest" class="header-anchor">#</a> <code>onRpcRequest</code></h2> <p>In order to communicate with Dapps and other snaps, the snap must implement its own JSON-RPC API by exposing an exported function called <code>onRpcRequest</code>. Whenever the snap receives a JSON-RPC request, the <code>onRpcRequest</code> handler function will be called with the below parameters.</p> <div class="custom-block tip"><p class="custom-block-title">Does my snap need to have an RPC API?</p> <p>Well, no, that's also up to you! If your snap can do something useful without receiving and responding to JSON-RPC requests, e.g. providing <a href="#ontransaction">transaction insights</a>, then you can skip exporting onRpcRequest. However, if you want to do something like manage the user's keys for a particular protocol and create a Dapp that sends transactions for that protocol via your snap, for example, you need to specify an RPC API.</p></div> <div class="custom-block warning"><p class="custom-block-title">Requesting the JSON-RPC permission</p> <p>In order for the extension to call the <code>onRpcRequest</code> method of the snap, the <code>endowment:rpc</code> permission must be requested. See <a href="/guide/snaps-permissions.html#endowment-rpc">Permissions</a></p></div> <h3 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h3> <ul><li><code>RpcHandlerArgs</code> - The origin and the JSON-RPC request.</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> JsonRpcRequest <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@metamask/types'</span><span class="token punctuation">;</span>
<span class="token keyword">interface</span> <span class="token class-name">RpcHandlerArgs</span> <span class="token punctuation">{</span>
  origin<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  request<span class="token operator">:</span> JsonRpcRequest<span class="token operator">&lt;</span><span class="token builtin">unknown</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">unknown</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="returns"><a href="#returns" class="header-anchor">#</a> Returns</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">RpcHandlerReturn</span> <span class="token operator">=</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">unknown</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
</code></pre></div><p><code>RpcHandlerReturn</code> - A promise containing the return of the implemented RPC Method.</p> <h3 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h3> <h4 id="typescript"><a href="#typescript" class="header-anchor">#</a> Typescript</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> OnRpcRequestHandler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@metamask/snap-types'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> onRpcRequest<span class="token operator">:</span> <span class="token function-variable function">OnRpcRequestHandler</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  origin<span class="token punctuation">,</span>
  request<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'hello'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token string">'world!'</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Method not found.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="javascript"><a href="#javascript" class="header-anchor">#</a> Javascript</h4> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function-variable function">onRpcRequest</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> origin<span class="token punctuation">,</span> request <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'hello'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token string">'world!'</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Method not found.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="ontransaction"><a href="#ontransaction" class="header-anchor">#</a> <code>onTransaction</code></h2> <p>If the snap wants to provide transaction insights before a user signs a transaction, the snap must export a function called <code>onTransaction</code>. Whenever there is a contract interaction and a transaction is submitted via the extension, this function will be called. The raw unsigned transaction payload will be passed to the <code>onTransaction</code> handler function.</p> <div class="custom-block warning"><p class="custom-block-title">Requesting the transaction insight permission</p> <p>In order for the extension to call the <code>onTransaction</code> method of the snap, the <code>endowment:transaction-insight</code> permission must be requested. See <a href="/guide/snaps-permissions.html#endowment-transaction-insight">Permissions</a> for more information.</p></div> <h3 id="parameters-2"><a href="#parameters-2" class="header-anchor">#</a> Parameters</h3> <ul><li><code>onTransactionArgs</code> - the raw transaction payload, the <a href="https://github.com/ChainAgnostic/CAIPs/blob/master/CAIPs/caip-2.md" target="_blank" rel="noopener noreferrer">CAIP-2 chain ID<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and the transaction origin if <a href="/guide/snaps-permissions.html#endowment-transaction-insight">allowTransactionOrigin</a> is set to <code>true</code>. For more details on the transaction object see <a href="https://metamask.github.io/SIPs/SIPS/sip-3#appendix-i-ethereum-transaction-objects" target="_blank" rel="noopener noreferrer">SIP-3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">OnTransactionArgs</span> <span class="token punctuation">{</span>
  transaction<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">unknown</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  chainId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  transactionOrigin<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">Getting the `transactionOrigin` parameter</p> <p>The <code>transactionOrigin</code> property is only passed to <code>onTransaction</code> if <code>allowTransactionOrigin</code> is set to <code>true</code> in the <code>endowment:transaction-insight</code> permission object. See <a href="/guide/snaps-permissions.html#endowment-transaction-insight">Permissions</a> for more information.</p></div> <h3 id="returns-2"><a href="#returns-2" class="header-anchor">#</a> Returns</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@metamask/snaps-ui'</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">OnTransactionHandlerReturn</span> <span class="token operator">=</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>OnTransactionResponse<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">interface</span> <span class="token class-name">OnTransactionResponse</span> <span class="token punctuation">{</span>
  content<span class="token operator">:</span> Component<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>onTransactionResponse</code> - The <code>content</code> object returned by the snap will be displayed using <a href="/guide/snaps-concepts.html#custom-ui">Custom UI</a> alongside the confirmation for the transaction that <code>onTransaction</code> was called with.</li></ul> <h3 id="examples-2"><a href="#examples-2" class="header-anchor">#</a> Examples</h3> <h4 id="typescript-2"><a href="#typescript-2" class="header-anchor">#</a> Typescript</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> OnTransactionHandler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@metamask/snap-types'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> panel<span class="token punctuation">,</span> heading<span class="token punctuation">,</span> text <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@metamask/snaps-ui'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> onTransaction<span class="token operator">:</span> <span class="token function-variable function">OnTransactionHandler</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  transactionOrigin
  transaction<span class="token punctuation">,</span>
  chainId<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> insights <span class="token operator">=</span> <span class="token comment">/* Get insights */</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    content<span class="token operator">:</span> <span class="token function">panel</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token function">heading</span><span class="token punctuation">(</span><span class="token string">'My Transaction Insights'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'Here are the insights:'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span><span class="token punctuation">(</span>insights<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>insight<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">text</span><span class="token punctuation">(</span>insight<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="javascript-2"><a href="#javascript-2" class="header-anchor">#</a> Javascript</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> panel<span class="token punctuation">,</span> heading<span class="token punctuation">,</span> text <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@metamask/snaps-ui'</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function-variable function">onTransaction</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
  transactionOrigin
  transaction<span class="token punctuation">,</span>
  chainId<span class="token punctuation">,</span>
<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> insights <span class="token operator">=</span> <span class="token comment">/* Get insights */</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token function">panel</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token function">heading</span><span class="token punctuation">(</span><span class="token string">'My Transaction Insights'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'Here are the insights:'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span><span class="token punctuation">(</span>insights<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">insight</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">text</span><span class="token punctuation">(</span>insight<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="oncronjob"><a href="#oncronjob" class="header-anchor">#</a> <code>onCronjob</code></h2> <p>If a snap wants to to run periodic actions for the user, the snap must export a function called <code>onCronjob</code>. This function will be called at the specified times with the specified payloads defined in the <code>endowment:cronjob</code> permission.</p> <div class="custom-block tip"><p class="custom-block-title">Requesting the cronjob permission</p> <p>In order for the extension to call the <code>onCronjob</code> method of the snap, the <code>endowment:cronjob</code> permission must be requested. See <a href="/guide/snaps-permissions.html#endowment-cronjob">Permissions</a></p></div> <h3 id="parameters-3"><a href="#parameters-3" class="header-anchor">#</a> Parameters</h3> <ul><li><code>onCronjobArgs</code> - exclusively containing an RPC request specified in the <code>endowment:cronjob</code> permission.</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">onCronjobArgs</span> <span class="token punctuation">{</span>
  request<span class="token operator">:</span> JsonRpcRequest<span class="token operator">&lt;</span><span class="token builtin">unknown</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">unknown</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="examples-3"><a href="#examples-3" class="header-anchor">#</a> Examples</h3> <h4 id="typescript-3"><a href="#typescript-3" class="header-anchor">#</a> Typescript</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> OnCronjobHandler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@metamask/snap-types'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> onCronjob<span class="token operator">:</span> <span class="token function-variable function">OnCronjobHandler</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> request <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'exampleMethodOne'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> wallet<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token operator">:</span> <span class="token string">'snap_notify'</span><span class="token punctuation">,</span>
        params<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">'inApp'</span><span class="token punctuation">,</span>
            message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, world!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Method not found.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="javascript-3"><a href="#javascript-3" class="header-anchor">#</a> Javascript</h4> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function-variable function">onCronjob</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> request <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'exampleMethodOne'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> wallet<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'snap_notify'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'inApp'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, world!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Method not found.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/MetaMask/metamask-docs/edit/main/docs/guide/snaps-exports.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/16/2023, 4:35:56 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/snaps-permissions.html" class="prev">
        Permissions
      </a></span> <span class="next"><a href="/guide/snaps-patching-dependencies.html">
        Patching Dependencies
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.b99f72c6.js" defer></script><script src="/assets/js/4.da077af0.js" defer></script><script src="/assets/js/37.c343127d.js" defer></script><script src="/assets/js/8.5b856ab8.js" defer></script>
  </body>
</html>
